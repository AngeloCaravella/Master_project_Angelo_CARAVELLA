# This yml file is used to configure the evsim simulation

##############################################################################
# Simulation Parameters
##############################################################################
timescale: 15 # in minutes per step
simulation_length: 112 # in steps per simulation

##############################################################################
# Date and Time
##############################################################################
# Year, month, 
year: 2022 # 2015-2023
month: 1 # 1-12
day: 17 # 1-31
# Whether to get a random date every time the environment is reset
random_day: True # True or False

# Simulation Starting Time
# Hour and minute do not change after the environment has been reset
hour: 5 # Simulation starting hour (24 hour format)
minute: 0 # Simulation starting minute (0-59)

# Simulate weekdays, weekends, or both
simulation_days: weekdays # weekdays, weekends, or both

# EV Spawn Behavior
scenario: workplace # public, private, or workplace
spawn_multiplier: 10 # 1 is default, the higher the number the more EVs spawn. Play somewhere between 3-7. With 1 often only 1/5 EVs show up.

##############################################################################
# Prices
##############################################################################
discharge_price_factor: 0.95 # Modificato da 1. È irrealistico che il prezzo di vendita (scarica) sia uguale a quello di acquisto. Questo modella un piccolo margine per l'operatore di rete.

##############################################################################
# Charging Network
##############################################################################
v2g_enabled: True # True or False
number_of_charging_stations: 25
number_of_transformers: 1
number_of_ports_per_cs: 1
# Provide path if you want to load a specific charging topology,
# else write None for a randomized one with the above parameters
charging_network_topology: None #./config_files/charging_topology_10.json

##############################################################################
# Power Setpoints Settings
##############################################################################
# How much the power setpoints can vary in percentage compared to the nominal power
# The higher the number the easier it is to meet the power setpoints, the opposite for negative numbers
power_setpoint_flexiblity: 10 # (in percentage +/- %)

##############################################################################
# Inflexible Loads, Solar Generation, and Demand Response
##############################################################################
# Whether to include inflexible loads in the transformer power limit, such as residential loads
tr_seed: -1 # seed for the random number generator of transformer loads(-1 for random seed)

inflexible_loads: # Offices, homes
  include: True # Modificato da False. Un luogo di lavoro ha sempre carichi di base (luci, computer, HVAC) che consumano energia e caricano il trasformatore.
  inflexible_loads_capacity_multiplier_mean: 1 
  forecast_mean: 30 
  forecast_std: 5 

# PV solar Power
solar_power:
  include: True # Modificato da False. Molti luoghi di lavoro moderni hanno pannelli solari. Questo crea uno scenario più realistico e interessante, con energia a basso costo disponibile durante il giorno.
  solar_power_capacity_multiplier_mean: 1 
  forecast_mean: 20 
  forecast_std: 5 

# Whether to include demand response in the transformer power limit
demand_response:
  include: True # Lasciato a False per non complicare eccessivamente lo scenario, ma potrebbe essere attivato per test più avanzati.
  events_per_day: 1
  event_capacity_percentage_mean: 35 
  event_capacity_percentage_std: 5 
  event_length_minutes_min: 60
  event_length_minutes_max: 60
  event_start_hour_mean: 12
  event_start_hour_std: 2
  notification_of_event_minutes: 60

##############################################################################
# EV Specifications
##############################################################################
heterogeneous_ev_specs: True #if False, each EV has the same specifications
# such as battery capacity, charging rate, etc.
ev_specs_file: ./ev2gym/data/ev_specs_v2g_enabled2024.json # path to the file with the EV specifications

##############################################################################
# Default Model values
##############################################################################
# These values are used if not using a charging network topology file or 
# if the EV specifications are not provided

# Default Transformer model
transformer:
  max_power: 100 # in kW. # Lasciato a 100kW. Questo valore è volutamente basso rispetto al carico teorico massimo (~550kW), creando un collo di bottiglia che rende necessario il controllo intelligente della carica.

# Default Charging Station model
charging_station:  
  min_charge_current: 0 # Amperes
  max_charge_current: 32 # Amperes
  min_discharge_current: 0 # Amperes (actual value <=0)
  max_discharge_current: -32 # Amperes (actual value <=0)
  voltage: 400 # Line-Line Voltage in Volts
  phases: 3 # 1,2, or 3

# Default EV model
ev:
  #The following values are used if "heterogeneous_ev_specs = False"
  battery_capacity: 50 # in kWh
  max_ac_charge_power: 11 # in kW
  min_ac_charge_power: 0 # in kW
  max_dc_charge_power: 50 # in kW
  max_discharge_power: -11 # in kW
  min_discharge_power: 0 # in kW
  ev_phases: 3  
  charge_efficiency: 0.95 # Modificato da 1 (100%). L'efficienza del 100% è fisicamente impossibile e causa Qlost=0. Un valore del 95% è più realistico per la ricarica AC.
  discharge_efficiency: 0.95 # Modificato da 1 (100%). Anche la scarica ha delle perdite. Questo garantirà che Qlost sia sempre maggiore di zero quando si fa V2G.
  transition_soc: 0.85 # Modificato da 1. Le batterie agli ioni di litio rallentano la carica dopo circa l'80-90% (fase a tensione costante). Questo modella tale comportamento in modo più realistico.

  #The following values are also used if "heterogeneous_ev_specs = True"
  min_battery_capacity: 15 # in kWh
  min_time_of_stay: 180 # in minutes
  min_emergency_battery_capacity: 25 # in kWh
  desired_capacity: 0.9 # Modificato da 1 (100%). È irrealistico che ogni utente voglia il 100% di carica. Il 90% è un obiettivo più comune e salutare per la batteria.
  #if trasition_soc is < 1, the curve of the line is affected by:
  transition_soc_multiplier: 5 # default 1 (the higher the number the shorter the effect of CCCV region)